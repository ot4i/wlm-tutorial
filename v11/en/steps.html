<!DOCTYPE html>
<html class="no-js" lang="en">
 
	
<!-- header::Start -->
	<head>
		<!-- Use Internet Explorer 9 Standards mode for Eclipse Browser Control - https://www.eclipse.org/swt/faq.php#browsernativeie and https://msdn.microsoft.com/en-us/library/jj676915%28v=vs.85%29.aspx -->
  		<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
		
		<!-- Next 2 http=equiv headers required to disable caching the Eclipse Browser Widget -->
		<meta http-equiv="Pragma" content="no-cache">
  		<meta http-equiv="Expires" content="-1">

		<meta charset="UTF-8"> 
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<meta name="copyright" content="Copyright IBM Corporation 2014" />
		<meta name="abstract" content="IBM App Connect Enterprise V11 Tutorial">
		<meta name="author" content="IBM">
		<meta name="description" content="IBM App Connect Enterprise V11 Tutorial">
		<meta name="keywords" content="keywords" > 
		<meta name="robots" content="index,follow">
		<meta name="source" content="IBM App Connect Enterprise V11 Tutorial" /> 
		
		<title>IBM App Connect Enterprise V11 Tutorial</title>

    	<link rel="stylesheet" href="https://ot4i.github.io/iib-tutorials/css/main.css" />
		<link rel="stylesheet" href="https://ot4i.github.io/iib-tutorials/css/app.css" />
    	
		<script src="https://ot4i.github.io/iib-tutorials/js/json2.js"></script>
		<script src="https://ot4i.github.io/iib-tutorials/js/js2java.js"></script>
		<script src="https://ot4i.github.io/iib-tutorials/js/js2java_steps.js"></script>
		<script src="https://ot4i.github.io/iib-tutorials/js/vendor/modernizr.js"></script>
	</head>
<!-- header::End -->
<!-- body::Start -->
		<body>
  	<!-- body content here -->
	<div class="row">
	  <div class="small-12 medium-12 large-12 columns">
	    <p> </p>
	  </div>
	</div>
	<div class="row">
	  <div class="small-9 medium-9 large-9 columns">
	    <h4 class="title">Using a Workload Management Policy to &#39;Throttle&#39; Throughput of a Message Flow <action><button class="small radius button" tabindex="0" id="stepsViewDetails" onclick="viewDetails()"> View Details</button> </action></h4>
	  </div>
	  <div class="small-3 medium-3 large-3 columns">
		<a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.msgbroker.helphome.doc/help_home_msgbroker.htm')" class="small right helplink">IBM Knowledge Center</a> 
	  </div>
	</div> 
	<hr>
	<div class="row">
		<div class="small-10 medium-10 large-10 columns">
		<h5> Learn how to use a Workload Management Policy to control the throughput of a message flow. </h5>
		</div>
		<div class="small-2 medium-2 large-2 columns">
			<button class="small radius button right" tabindex="0" id="backToGallery" onclick="backToGallery()"> Back To Gallery
			</button>
		</div>
	</div>
	<div class="row">          
		  <div class="small-12 medium-12 large-12 columns">
			<ul class="tabs vertical"> 
				<li class="tab-title tab-title-small active">
				  <a href="javascript:;" onclick="show('panel21')">Create</a> 
				</li>
				<li class="tab-title tab-title-small">
				  <a href="javascript:;" onclick="show('panel31')">Prepare</a> 
				</li>
				<li class="tab-title tab-title-small">
				  <a href="javascript:;" onclick="show('panel41')">Run</a> 
				</li>
			</ul>
			<!-- editing -->
			<div class="tabs-content panel-thin-blue vertical"> 
		    	<div class="content active" id="panel21">
		    		
		    		<div class="small-10 medium-10 large-10 columns divider">
					
				      	<div class="row content-details">
					      	<h4>Import projects</h4>
					        
						    
								<p> Click <span class="uicontrol">Import</span> to add the required projects to your workspace: </p>
								
								
									
									<ol>
									
									
										<li> The application named <span class="application">WorkloadManagementApplication</span> contains the following resources.
										
										
											
											<ul>
											
												
													<li> A message flow named <span class="msgflow">WorkloadManagementFlow</span> that receives an HTTP message, performs a simple transformation and then sends an HTTP reply.</li>
												
													<li> An XML input message named <span class="resource">TestMessage.xml</span> to test the message flow with.</li>
												
													<li> A BAR File named <span class="resource">wlm.bar</span> which contains <span class="application">WorkloadManagementApplication</span>, which itself contains <span class="msgflow">WorkloadManagementFlow</span>. The message flow has been configured to refer to the Workload Management policy (which is described below).</li>
												
											
											</ul>
											
										
										</li>
									
										<li> The policy project named <span class="application">MyPolicies</span> contains a Workload Management Policy named <span class="application">WLM_MaxRate_Policy</span>. To start with this policy defines a Maximum Rate (messages per second) of 100,000. Later in the tutorial we will show the impact of changing this threshold.
										
										</li>
									
										<li> The two java projects named <span class="application">PerfHarness</span> and <span class="application">HTTPPerfHarness</span> jointly provide a testing capability which we will use to drive workload through the message flow.
										
										</li>
									
									
									</ol>
									
								
							
						</div>
						
						<div class="row content-details">
							<h4>Find out more</h4>
							<ul>
							
								
																
								<li> <a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.mft.doc/bj58250_.htm')" title="Knowledge Center link to Workload management">Workload management</a> </li>
							   	
							
								
																
								<li> <a href="javascript:;" onclick="openHelpSystem('/com.ibm.etools.mft.doc/bj58270_.htm')" title="Knowledge Center link to Setting the maximum rate for a message flow">Setting the maximum rate for a message flow</a> </li>
							   	
							
							</ul>
						</div>
						
					</div>
					
					<div class="small-2 medium-2 large-2 columns">
					
					
					<h4 class="tkaction"><a href="javascript:;" onclick="importArtifacts(); openResource('EventRoutingFlow')"> Import <img class="icon-image" src="https://ot4i.github.io/iib-tutorials/images/icons/ibmdesign/back-right-previous_128-orange.png"></a></h4>
										
				    </div>
					
		    	</div>
		    	<div class="content" id="panel31">
					
		    		<div class="small-10 medium-10 large-10 columns divider">
					
						<div class="row content-details">
						  	<h4></h4>
						    
						    
								<p> <h4>Deploy the Application, Message Flow and Workload Management Policy</h4> </p>
								
							
								<p> This tutorial assumes you have an Integration node owned integration server, or a stand-alone integration server already created. Other tutorials in the tutorial gallery will help you with this if you're not sure what this means. </p>
								
							
								<p> To deploy the artifacts either click the Deploy link on the right, or locate the provided BAR file named <span class="msgflow">wlm.bar</span> inside the application project named <span class="application">WorkloadManagementApplication</span>, and drag and drop it on to your integration server in the Integration Explorer view (by default shown in the bottom left corner of your Toolkit). </p>
								
							
						</div>
							
					</div>
					
					<div class="small-2 medium-2 large-2 columns">
					
					
					<h4 class="tkaction"><a href="javascript:;" onclick="deployArtifacts()"> Deploy <img class="icon-image" src="https://ot4i.github.io/iib-tutorials/images/icons/ibmdesign/back-right-previous_128-orange.png"></a></h4>						
				    					
				    </div>
					
		    	</div>
		    	<div class="content" id="panel41">
		    		
					<div class="small-12 medium-12 large-12 columns">
					
				    	<div class="row content-details">
					      	<h4>Test the scenario</h4>
					        
						    
								<p> To test the scenario, you will generate a workload of messages for the message flow which runs for one minute. The message processing rate will be reported. Next, you will update the Workload Management Policy and redeploy it before repeating the one minute test, which will demonstrate the message processing rate being limited. </p>
								
							
								<p> <h4>Generating a workload of messages</h4> </p>
								
							
								<p> The PerfHarness Test Tool is a small java utility written by IBM and freely available to help you generate a workload of HTTP request messages that are processed by the <span class="msgflow">WorkloadManagementFlow</span> message flow. The link below provides more details about the PerfHarness tool, but for simplicity the tool is already available for you to run from your Toolkit workspace using the projects you imported earlier in this tutorial: </p>
								
								
									
									<ol>
									
									
										<li> Check the properties of your integration server to determine which port is being used by the HTTP Input node in the deployed message flow. By default this is likely to be port 7800.
										
										</li>
									
										<li> Expand the <span class="application">src</span> folder of the <span class="application">PerfHarness</span> project, right-click <span class="application">JMSPerfHarness.java</span> and choose the menu option Run > Run Configurations.
										
										</li>
									
										<li> On the <span class="application">Main</span> tab, check that <span class="varname">Project = PerfHarness</span> and <span class="varname">Main class = JMSPerfHarness</span>
										
										</li>
									
										<li> On the <span class="application">Arguments</span> tab, copy and paste the following into the Program arguments text window: <code>-tc http.HTTPRequestor -rl 60 -jh localhost -jp <span class="varname">{HTTPPort}</span> -mf <span class="varname">{WorkspacePath}</span>/WorkloadManagementApplication/TestMessages/TestMessage.xml -wi 10 -to 10000 -sh false -ws 1 -dn 1 -sc BasicStats -ss 5 -nt 1 -ur wlm</code><br>where:<br><span class="varname">{HTTPPort}</span> is the port the Integration Server is listening on for HTTP requests from the previous step<br><span class="varname">{WorkspacePath}</span> is the location of your current Toolkit workspace.
										
										</li>
									
										<li> On the <span class="application">Classpath</span> tab, select <span class="application">User Entries</span>, click <span class="application">Add Projects</span>, and select the <span class="application">HTTPPerfHarness</span> and <span class="application">PerfHarness</span> projects
										
										</li>
									
										<li> When you click Run, the PerfHarness will run for 60 seconds and every 5 seconds output the message rate at which it is processing messages. The actual message rate achieved will be dependent upon the performance of your system but it needs to be in excess of 1 message per second for you to observe the effects of applying the Workload Management Policy in this tutorial.
										
										</li>
									
									
									</ol>
									
								
							
								<p> <h4>Redeploy the Workload Management Policy with a lower rate to restrict the message throughput</h4> </p>
								
							
								<p> Use the <span class="application">WLM_MaxRate_Policy</span> Workload Management Policy to restrict the throughput of the <span class="msgflow">WorkloadManagementFlow</span> message flow by completing the following steps: </p>
								
								
									
									<ol>
									
									
										<li> Look inside the <span class="application">MyPolicies</span> project, open <span class="application">WLM_MaxRate_Policy</span> and change the <span class="application">Maximum Rate (Messages per second)</span> parameter from its current value of 100000 to the value 1.
										
										</li>
									
										<li> Deploy the update by dragging and dropping the <span class="application">MyPolicies</span> project on to the integration server.
										
										</li>
									
									
									</ol>
									
								
							
								<p> <h4>Re-run the workload with the new Workload Management Policy in place</h4> </p>
								
							
								<p> Now the Workload Management Policy has been updated, repeat the same test as before and observe that the message processing rate has now been limited to 1 message per second. </p>
								
							
						</div>
						
						<div class="row content-details"> 	
							<h4>Find out more</h4>
							<ul>
							
								
								
								<li> <a href="javascript:;" onclick="openExternalBrowser('https://developer.ibm.com/open/2016/05/12/performance-testing-with-perfharness/')" title="developerWorks link to  Performance testing with PerfHarness">Performance testing with PerfHarness</a> </li>
									
							
								
								
								<li> <a href="javascript:;" onclick="openExternalBrowser('https://github.com/ot4i/perf-harness?cm_mc_uid=42692352179214933019160&amp;cm_mc_sid_50200000=')" title="GitHub link to  PerfHarness download">PerfHarness download</a> </li>
									
							
							</ul>
						</div>
							
					</div>
					
				</div>	
			</div> <!-- tab-content -->
		</div> <!-- columns -->
	  </div> <!-- row --></body>
		<script src="https://ot4i.github.io/iib-tutorials/js/vendor/jquery.js"></script>
		<script src="https://ot4i.github.io/iib-tutorials/js/vendor/foundation.min.js"></script>
		<script src="https://ot4i.github.io/iib-tutorials/js/main.js"></script>
	</body>
<!-- body::End -->

</html>